{"version":3,"sources":["src/pong/scripts/main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","now","Events","callable","fun","trigger","cont","animating","restart","starttime","minrefresh","controller","time","deltatime","count","fpsSmooth","fps","dataObj","smooth","Math","min","lasttime","requestAnimationFrame","emit","start","Object","defineProperties","configurable","get","data","fpsSmoothingCoefficient","set","d","isNaN","minRefresh","stop","undefined","events","performance-now","requestanimationframe","2","cleanUpNextTick","draining","currentQueue","queue","concat","queueIndex","drainQueue","timeout","cachedSetTimeout","len","run","cachedClearTimeout","Item","array","this","noop","process","setTimeout","clearTimeout","nextTick","args","Array","arguments","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","binding","name","cwd","chdir","dir","umask","3","EventEmitter","_events","_maxListeners","isFunction","arg","isNumber","isObject","isUndefined","defaultMaxListeners","setMaxListeners","TypeError","type","er","handler","listeners","error","err","context","slice","listener","m","newListener","warned","console","trace","g","fired","list","position","splice","key","ret","listenerCount","evlistener","emitter","4","getNanoSeconds","hrtime","loadTime","performance","hr","Date","getTime","_process","5","global","webkitRequestAnimationFrame","cancelAnimationFrame","lastTime","callback","currTime","timeToCall","max","id","define","window","6","$element","pause","resume","newGameStart","direction","running","newGame","log","keydown","event","prev","which","preventDefault","keyup","7","square","x","sgn","NaN","fillNumber","x0","y0","width","height","lineWidth","number","fillRect","$","animate","keyboardInput","CP","CanvasRenderingContext2D","lineTo","dashedLine","y","x2","y2","dashArray","moveTo","dx","dy","slope","distRemaining","sqrt","dashIndex","draw","dashLength","xStep","document","ready","k","show","hide","keys","resetAll","score","SmartInterval","clearInterval","setInterval","clear","vector","reset","goldenRatio","canvas","parent","h","w","ctx","getContext","paddleCenter","paddleSpeed","paddleHeight","paddleWidth","cpu","speedConst","pow","roundLost","posReset","downTime","ballCenter","ballHeight","ballVeloc","vec","random","maxAngle","atan2","magnitude","angle","cos","sin","ballAcel","canvasBackground","chooseCpu","el","isCpu","html","click","makeFlash","td","flash","black","c","css","color","mouseover","mouseout","checkScore","_i","bounce","v1","s1","H","theta1","atan","abs","theta2","PI","tanTheta2","tan","setupCanvas","fillStyle","strokeStyle","beginPath","stroke","tmp","createElement","onload","src","toDataURL","maxCharacters","rows","testEl","setupMenu","fontSize","lineHeight","font-size","characterWidth","widthNeeded","spaceAbove","maxHeight","left","top","line-height","pauseFont","remove","accelarate","_i2","actualDirection","speed","kV","kH","drawImage","_i3","numWidth","numHeight","./keyboard","animation-timer2","jquery"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\r\nvar now = require('performance-now');\r\nrequire('requestanimationframe');\r\n\r\nvar Events = require('events');\r\n\r\nvar callable = function (fun) {\r\n    return fun && fun.call;\r\n};\r\n\r\n/**\r\n * animation-timer module.\r\n *\r\n * @see {README.md}\r\n * @module animation-timer\r\n */\r\n\r\nmodule.exports = function animate(trigger) {\r\n    'use strict';\r\n    var cont        = false,\r\n        animating   = false,\r\n        restart     = false,\r\n        starttime   = 0,\r\n        minrefresh  = 0,\r\n        controller  = new Events(),\r\n        time        = 0,\r\n        deltatime   = 0,\r\n        count       = 0,\r\n        fpsSmooth   = 0.9,\r\n        fps         = 0, // waited mean average\r\n        dataObj     = {\r\n            get time      () { return time; },\r\n            get deltatime () { return deltatime; },\r\n            get count     () { return count; },\r\n            get fps       () { return fps; }\r\n        },\r\n        a = function () {\r\n\r\n            var smooth      = Math.min(1, count / 5) * fpsSmooth,\r\n                lasttime    = time;\r\n                \r\n            time            = now() - starttime;\r\n            deltatime       = time - lasttime;\r\n            fps             = fps * smooth + (1 - smooth) / (deltatime / 1000);\r\n            \r\n            if (cont) {\r\n                requestAnimationFrame(a);\r\n                if(minrefresh < dataObj.deltatime){\r\n                    controller.emit('animate', dataObj);                    \r\n                }else{\r\n                    time = lasttime;\r\n                }\r\n            } else {\r\n                animating = false;\r\n                controller.emit('stop', dataObj);\r\n                if (restart) {\r\n                    restart = false;\r\n                    start();\r\n                }\r\n            }\r\n            \r\n            count++;\r\n        },\r\n        start = function () {\r\n            /* start animation */\r\n            cont        = animating = true;\r\n            time        = 0;\r\n            deltatime   = 0;\r\n            count       = 0;\r\n            fps         = 0; // start value, seems resonable\r\n            starttime   = now();\r\n            controller.emit('start', dataObj);\r\n            requestAnimationFrame(a);\r\n        };\r\n\r\n\r\n    Object.defineProperties(controller,{\r\n        animating: {\r\n            configurable: true,\r\n            get: function() { return animating; },\r\n        },\r\n        data: {\r\n            configurable: true,\r\n            get: function() { return dataObj; },\r\n        },\r\n        fpsSmoothingCoefficient: {\r\n            configurable: true,\r\n            get: function() { return fpsSmooth },\r\n            set: function(d) { \r\n                if(!isNaN(d) && 0 < d && d < 1) fpsSmooth = d;\r\n            },\r\n        },\r\n        minRefresh: {\r\n            configurable: true,\r\n            get: function() { return minrefresh; },\r\n            set: function(r) { \r\n                if(!isNaN(r) && r >= 0) minrefresh = r;\r\n            }   \r\n        }\r\n    });\r\n    \r\n    controller.start = function () {\r\n        if (!animating) { start(); }\r\n        return controller;\r\n    };\r\n    \r\n    controller.restart = function () {\r\n        if (animating) {\r\n            /* animation has been previously started and not\r\n                yet stopped */\r\n            restart = true;\r\n            cont    = false;\r\n        } else {\r\n            start();\r\n        }\r\n        return controller;\r\n    };\r\n    \r\n    controller.stop = function () {\r\n        cont = false;\r\n        return controller;\r\n    };\r\n    \r\n    if (callable(trigger))\r\n        trigger.call(undefined, controller);\r\n    \r\n    return controller;\r\n};\n},{\"events\":3,\"performance-now\":4,\"requestanimationframe\":5}],2:[function(require,module,exports){\n// shim for using process in browser\n\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\n(function () {\n  try {\n    cachedSetTimeout = setTimeout;\n  } catch (e) {\n    cachedSetTimeout = function () {\n      throw new Error('setTimeout is not defined');\n    }\n  }\n  try {\n    cachedClearTimeout = clearTimeout;\n  } catch (e) {\n    cachedClearTimeout = function () {\n      throw new Error('clearTimeout is not defined');\n    }\n  }\n} ())\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = cachedSetTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    cachedClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        cachedSetTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],3:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],4:[function(require,module,exports){\n(function (process){\n// Generated by CoffeeScript 1.7.1\n(function() {\n  var getNanoSeconds, hrtime, loadTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - loadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    loadTime = getNanoSeconds();\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(this);\n\n}).call(this,require('_process'))\n},{\"_process\":2}],5:[function(require,module,exports){\n/**\n * requestAnimationFrame version: \"0.0.23\" Copyright (c) 2011-2012, Cyril Agosta ( cyril.agosta.dev@gmail.com) All Rights Reserved.\n * Available via the MIT license.\n * see: http://github.com/cagosta/requestAnimationFrame for details\n *\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n * requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel\n * MIT license\n *\n */\n\n\n( function( global ) {\n\n\n    ( function() {\n\n\n        if ( global.requestAnimationFrame ) {\n\n            return;\n\n        }\n\n        if ( global.webkitRequestAnimationFrame ) { // Chrome <= 23, Safari <= 6.1, Blackberry 10\n\n            global.requestAnimationFrame = global[ 'webkitRequestAnimationFrame' ];\n            global.cancelAnimationFrame = global[ 'webkitCancelAnimationFrame' ] || global[ 'webkitCancelRequestAnimationFrame' ];\n            return;\n\n        }\n\n        // IE <= 9, Android <= 4.3, very old/rare browsers\n\n        var lastTime = 0;\n\n        global.requestAnimationFrame = function( callback ) {\n\n            var currTime = new Date().getTime();\n\n            var timeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n\n            var id = global.setTimeout( function() {\n\n                callback( currTime + timeToCall );\n\n            }, timeToCall );\n\n            lastTime = currTime + timeToCall;\n\n            return id; // return the id for cancellation capabilities\n\n        };\n\n        global.cancelAnimationFrame = function( id ) {\n\n            clearTimeout( id );\n\n        };\n\n    } )();\n\n    if ( typeof define === 'function' ) {\n\n        define( function() {\n\n            return global.requestAnimationFrame;\n\n        } );\n\n    }\n\n} )( window );\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = function keyboardInput($element, pause, resume, newGameStart) {\n\n    var key = {};\n\n    key.direction = [0, 0];\n    key.running = false;\n    key.newGame = true;\n\n    console.log($element);\n    $element.keydown(function (event) {\n        var prev = true;\n        switch (event.which) {\n            case 38:\n                key.direction[1] = -1;break; // Up       (right up)\n            case 40:\n                key.direction[1] = +1;break; // Down     (right down)\n            case 87:\n                key.direction[0] = -1;break; // W        (left up)\n            case 83:\n                key.direction[0] = +1;break; // S        (right down)\n            default:\n                prev = false;\n        }\n        if (prev) event.preventDefault();\n\n        // P key restarts the game\n        if (event.which === 80) {\n            if (key.running) {\n                pause(key);\n            } else {\n                resume(key);\n            }\n        }\n        // enter creates new game if on menu screen\n        else if (event.which === 13 && key.newGame) {\n                newGameStart();\n            }\n    }).keyup(function (event) {\n        switch (event.which) {\n            case 38:\n                if (key.direction[1] === -1) key.direction[1] = 0;break;\n            case 40:\n                if (key.direction[1] === +1) key.direction[1] = 0;break;\n            case 87:\n                if (key.direction[0] === -1) key.direction[0] = 0;break;\n            case 83:\n                if (key.direction[0] === +1) key.direction[0] = 0;break;\n        }\n    });\n    return key;\n};\n\n},{}],7:[function(require,module,exports){\n'use strict';\n\nvar $ = require('jquery'),\n    animate = require('animation-timer2'),\n    keyboardInput = require('./keyboard');\n\nfunction square(x) {\n    return x * x;\n}\n\nfunction sgn(x) {\n    return typeof x === 'number' ? x ? x < 0 ? -1 : 1 : x === x ? 0 : NaN : NaN;\n}\n\nvar CP = window.CanvasRenderingContext2D && CanvasRenderingContext2D.prototype;\n\nif (CP && CP.lineTo) {\n    /*\r\n     *    (x,y) is line begin coordinates\r\n     *    (x2,y2) is line end coordinates\r\n     *    dashArray should contain the lengths of dashes and will be cycled through\r\n     */\n    CP.dashedLine = function (x, y, x2, y2, dashArray) {\n        if (!dashArray) {\n            dashArray = [10, 5];\n        }\n        // beginning on line\n        this.moveTo(x, y);\n        // gradient\n        var dx = x2 - x,\n            dy = y2 - y;\n        if (dx === 0) dx = 1e-15;\n        var slope = dy / dx;\n\n        // length of line\n        var distRemaining = Math.sqrt(dx * dx + dy * dy);\n\n        // cycles through dashes and gaps\n        var dashIndex = 0,\n            draw = true;\n        while (distRemaining >= 0.1) {\n            // length is taken from array or shortened if line is almost over\n            var dashLength = Math.min(dashArray[dashIndex % dashArray.length], distRemaining);\n\n            if (dashLength == 0) {\n                dashLength = 0.001; // Hack for Safari\n            }\n\n            var xStep = sgn(dx) * dashLength / Math.sqrt(1 + slope * slope);\n\n            // adjust x and y for next dash/gap\n            x += xStep;\n            y += slope * xStep;\n\n            // draw dash or skip over a gap\n            this[draw ? 'lineTo' : 'moveTo'](x, y);\n            distRemaining -= dashLength;\n            draw = !draw;\n            ++dashIndex;\n        }\n    };\n}\n\nfunction fillNumber(context, x0, y0, width, height, lineWidth, number) {\n    switch (number) {\n        case 0:\n            // top and bottom\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + height - lineWidth, width, lineWidth);\n            // sides\n            context.fillRect(x0, y0, lineWidth, height);\n            context.fillRect(x0 + width - lineWidth, y0, lineWidth, height);\n            break;\n        case 1:\n            // top (half width)\n            context.fillRect(x0, y0, width / 2 + lineWidth / 2, lineWidth);\n            // vertical line\n            context.fillRect(x0 + width / 2 - lineWidth / 2, y0, lineWidth, height);\n            // base (full width)\n            context.fillRect(x0, y0 + height - lineWidth, width, lineWidth);\n            break;\n        case 2:\n            // top, middle and bottom horizontal lines\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth), width, lineWidth);\n            // vertical lines at top right and bottom left\n            context.fillRect(x0 + (width - lineWidth), y0, lineWidth, (height + lineWidth) / 2);\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, lineWidth, (height + lineWidth) / 2);\n            break;\n        case 3:\n            // top, bottom horizontal lines\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth), width, lineWidth);\n            // middle horizontal line (slightly shorter)\n            context.fillRect(x0 + width / 5, y0 + (height - lineWidth) / 2, width * 4 / 5, lineWidth);\n            // vertical line at right\n            context.fillRect(x0 + (width - lineWidth), y0, lineWidth, height);\n            break;\n        case 4:\n            // middle horizontal line\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, width, lineWidth);\n            // vertical line at top left\n            context.fillRect(x0, y0, lineWidth, (height + lineWidth) / 2);\n            // vertical line at right\n            context.fillRect(x0 + (width - lineWidth), y0, lineWidth, height);\n            break;\n        case 5:\n            // top, middle and bottom horizontal lines\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth), width, lineWidth);\n            // vertical lines at top left and bottom right\n            context.fillRect(x0, y0, lineWidth, (height + lineWidth) / 2);\n            context.fillRect(x0 + (width - lineWidth), y0 + (height - lineWidth) / 2, lineWidth, (height + lineWidth) / 2);\n            break;\n        case 6:\n            // top, middle and bottom horizontal lines\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth), width, lineWidth);\n            // vertical line at left\n            context.fillRect(x0, y0, lineWidth, height);\n            // vertical line at bottom right\n            context.fillRect(x0 + (width - lineWidth), y0 + (height - lineWidth) / 2, lineWidth, (height + lineWidth) / 2);\n            break;\n        case 7:\n            // top (full width)\n            context.fillRect(x0, y0, width * 4 / 5 + lineWidth / 2, lineWidth);\n            // vertical line at leftish\n            context.fillRect(x0 + (width * 4 / 5 - lineWidth / 2), y0, lineWidth, height);\n            // horizontal line at middle (half width)\n            context.fillRect(x0 + (width - lineWidth) / 2, y0 + (height - lineWidth) / 2, (width + lineWidth) / 2, lineWidth);\n            break;\n        case 8:\n            // top, middle and bottom horizontal lines\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth), width, lineWidth);\n            // vertical line at left and right\n            context.fillRect(x0, y0, lineWidth, height);\n            context.fillRect(x0 + (width - lineWidth), y0, lineWidth, height);\n            break;\n        case 9:\n            // top, middle horizontal lines\n            context.fillRect(x0, y0, width, lineWidth);\n            context.fillRect(x0, y0 + (height - lineWidth) / 2, width, lineWidth);\n            // vertical line at right\n            context.fillRect(x0 + (width - lineWidth), y0, lineWidth, height);\n            // vertical line at top left\n            context.fillRect(x0, y0, lineWidth, (height + lineWidth) / 2);\n            break;\n    }\n}\n\n$(document).ready(function () {\n\n    var pause = function pause(k) {\n        $(\"#pause\").show();\n        k.running = false;\n    };\n    var resume = function resume(k) {\n        $(\"#pause\").hide();\n        setTimeout(function () {\n            k.running = true;\n        }, 400);\n    };\n\n    var newGameStart = function newGameStart() {\n        keys.running = true;\n        keys.newGame = false;\n        resetAll();\n        for (var i = 0; i < score.length; ++i) {\n            score[i] = 0;\n        }$(\"#newgame\").hide();\n        $(\"#pause\").hide();\n    };\n\n    var SmartInterval = function SmartInterval(f, i) {\n        this.id = 0;\n        this.set(f, i);\n    };\n\n    SmartInterval.prototype.set = function (f, i) {\n        if (typeof f !== 'function') return;\n        if (typeof i === 'undefined') i = 1000;\n        // clear existing interval\n        if (this.id) clearInterval(this.id);\n        this.id = setInterval(f, i);\n    };\n    SmartInterval.prototype.clear = function () {\n        if (this.id !== 0) {\n            clearInterval(this.id);\n            this.id = 0;\n        }\n    };\n    /*\r\n     * x0 could alternatively be a function that sets the values of x and y\r\n     * if so it must take a vector object as its first paramenter\r\n     * \r\n     */\n    var vector = function vector(x0, y0) {\n        if (typeof x0 !== 'function') {\n            this.reset = function () {\n                this.x = x0;\n                this.y = y0;\n                return this;\n            };\n        } else {\n            this.reset = function () {\n                return x0(this, arguments);\n            };\n        }\n        this.reset();\n    };\n\n    var goldenRatio = 1.61803398875;\n    var keys = keyboardInput($(document), pause, resume, newGameStart);\n    var canvas = $(\"#map\");\n\n    canvas[0].width = canvas.parent().width();\n    canvas[0].height = canvas.parent().height();\n    var h = canvas[0].height;\n    var w = canvas[0].width;\n\n    var ctx = canvas[0].getContext(\"2d\");\n\n    var paddleCenter = [new vector(h * 3 / 100, h / 2), new vector(w - 3 * h / 100, h / 2)];\n    var paddleSpeed = [0, 0];\n    var paddleHeight = Math.sqrt(h) * 3;\n    var paddleWidth = h / 50;\n    var cpu = [false, false];\n    var speedConst = 3 / 40 * Math.pow(h, 3 / 4);\n\n    var score = [0, 0];\n    var roundLost = 0;\n    var posReset = false;\n    var downTime = 0.5;\n\n    var ballCenter = new vector(w / 2, h / 2);\n    var ballHeight = h / 40;\n    // ball will move with speed (magnitude) of w/150\n    // at an angle which means it will hit the paddle without it being moved\n    var ballVeloc = new vector(function (vec) {\n        if (typeof vec.dir === 'undefined' || !vec.dir || vec.dir !== 1 && vec.dir !== -1) vec.dir = (Math.random() < 0.5) * 2 - 1;\n        var maxAngle = Math.atan2((paddleHeight + ballHeight) / 2.1, w / 2 - h / 25 - ballHeight / 2);\n        var magnitude = w / 150;\n        var angle = maxAngle * (Math.random() - 0.5);\n        vec.x = magnitude * Math.cos(angle) * vec.dir;\n        vec.y = magnitude * Math.sin(angle);\n        vec.dir = 0;\n        return vec;\n    });\n    var ballAcel = w / 125000;\n    var canvasBackground = false;\n\n    var resetAll = function resetAll() {\n        ballCenter.reset();\n        ballVeloc.reset();\n        for (var i = 0; i < paddleCenter.length; ++i) {\n            paddleCenter[i].reset();\n        }\n    };\n\n    var chooseCpu = function chooseCpu(el, isCpu, n) {\n        cpu[n] = isCpu;\n        if (isCpu) {\n            el.html(\"CPU (CLICK TO CHANGE)\");\n        } else {\n            el.html(\"PLAYER (CLICK TO CHANGE)\");\n        }\n    };\n    chooseCpu($(\"#cpu1\"), true, 0);\n    chooseCpu($(\"#cpu2\"), false, 1);\n    $(\"#cpu1\").click(function () {\n        chooseCpu($(this), !cpu[0], 0);\n    });\n    $(\"#cpu2\").click(function () {\n        chooseCpu($(this), !cpu[1], 1);\n    });\n    $(\"#begin\").click(function () {\n        newGameStart();\n    });\n    $(\"#restart\").click(function () {\n        $(\"#pause\").hide();\n        keys.newGame = true;\n        $(\"#newgame\").show();\n    });\n    $(\"#restartWin\").click(function () {\n        $(\"#winner\").hide();\n        keys.newGame = true;\n        $(\"#newgame\").show();\n    });\n    $(\"#resume\").click(function () {\n        resume(keys);\n    });\n\n    var makeFlash = function makeFlash(td) {\n        var el = false;\n        var flash = function flash(black) {\n            if (el) {\n                var c = black ? 'black' : 'white';\n                el.css({\n                    'color': c\n                });\n                var t = black ? 300 : 300;\n                setTimeout(function () {\n                    flash(!black);\n                }, t);\n            }\n        };\n        td.mouseover(function () {\n            el = $(this);\n            var black = true;\n            flash(black);\n        }).mouseout(function () {\n            el = false;\n            $(this).css({\n                'color': ''\n            });\n        });\n    };\n    for (var i = 0; i < $(\".select\").length; ++i) {\n        makeFlash($($(\".select\")[i]));\n    }var checkScore = function checkScore() {\n        for (var _i = 0; _i < score.length; ++_i) {\n            if (score[_i] == 10) {\n                $(\"#winName\").html(_i == 0 ? 'Left' : 'Right');\n                $(\"#winner\").show();\n                keys.running = false;\n            }\n        }\n    };\n\n    var bounce = function bounce(i) {\n        var v1 = ballVeloc;\n        var s1 = ballCenter;\n        // x is position of ball in relation to center of paddle\n        var x = paddleCenter[i].y - s1.y;\n        // H is the height of the (paddle+half the ball)\n        var H = paddleHeight / 2 + ballHeight / 2;\n        var theta1 = Math.atan(-v1.y / Math.abs(v1.x));\n        var k = x / H;\n\n        var theta2 = sgn(v1.x) * (-k * Math.PI - 6 * theta1) / 8; //-sgn(theta1)*((1-k)*Math.abs(theta1) + k*Math.PI/2);\n        var tanTheta2 = Math.tan(theta2);\n\n        ballVeloc.x = -sgn(v1.x) * Math.sqrt((square(v1.x) + square(v1.y)) / (1 + square(tanTheta2)));\n        ballVeloc.y = -tanTheta2 * ballVeloc.x;\n    };\n\n    // setup canvas\n    var setupCanvas = function setupCanvas() {\n        ctx.fillStyle = 'white';\n        ctx.strokeStyle = 'white';\n        ctx.lineWidth = h / 75;\n        // draw top and bottom lines\n        ctx.fillRect(h / 50, h / 50, w - h / 25, h / 50);\n        ctx.fillRect(h / 50, h * 48 / 50, w - h / 25, h / 50);\n        // draw dividing line\n        ctx.beginPath();\n        ctx.dashedLine(w / 2, h * 4 / 75, w / 2, h * 71 / 75, [h / 75]);\n        ctx.stroke();\n    };\n    setupCanvas();\n    var tmp = document.createElement('img');\n    tmp.onload = function () {\n        canvasBackground = tmp;\n    };\n    tmp.src = canvas[0].toDataURL(\"image/png\");\n\n    // setup menus\n    // note ratio of width to characters is same for all collumns\n    var maxCharacters = 60; // most characters in any row\n    var rows = 7;\n    var testEl = $(\"#characterTest\");\n    var setupMenu = function setupMenu(fontSize, lineHeight) {\n        testEl.css({\n            'font-size': fontSize\n        });\n        var characterWidth = $(\"#characterTest\").width();\n        var widthNeeded = characterWidth * maxCharacters;\n        var spaceAbove = h * (6 + 5 * goldenRatio) / 50;\n        var maxHeight = h - 1.5 * spaceAbove;\n        if (widthNeeded >= w * 4 / 5) {\n            setupMenu(fontSize / 2, lineHeight);\n        } else {\n            while (maxHeight < fontSize * lineHeight * rows) {\n                if (lineHeight <= 1.2) {\n                    setupMenu(fontSize / 2, 1.2);\n                    return;\n                } else {\n                    lineHeight -= 0.2;\n                }\n            }\n            $(\".menu\").css({\n                left: (w - widthNeeded) / 2,\n                top: spaceAbove,\n                width: widthNeeded,\n                'font-size': fontSize,\n                'line-height': lineHeight\n            });\n            var pauseFont = Math.min(35 / 18 * lineHeight * fontSize, fontSize * 2);\n            $(\".large\").css({\n                'font-size': pauseFont,\n                'line-height': Math.min(lineHeight * 7 / 3 * fontSize / pauseFont, 2)\n            });\n            $(\"#characterTest\").remove();\n        }\n    };\n    setupMenu(25, 2);\n\n    // for pause menu, 1/5th characters wide, 3/7ths rows high\n\n    animate(function (controller) {\n        controller.start();\n        controller.on('animate', function (event) {\n            if (keys.running) {\n                // move ball\n                if (roundLost >= 0) {\n                    roundLost -= 1 / (event.fps * downTime);\n                    if (roundLost < 0.5 && !posReset) {\n                        resetAll();\n                        posReset = true;\n                    }\n                } else {\n                    var accelarate = function accelarate(m) {\n                        ballVeloc[m] *= 1 + Math.abs(ballAcel / ballVeloc.x);\n                        ballCenter[m] += ballVeloc[m];\n                    };\n                    accelarate('x');\n                    accelarate('y');\n                    // bounce ball off top/bottom\n                    if (ballVeloc.y > 0 // going down\n                    && ballCenter.y + ballHeight / 2 > h * 24 / 25 || // below bottom\n                    ballVeloc.y < 0 // going up\n                    && ballCenter.y - ballHeight / 2 < h / 25) // above top\n                        {\n                            ballVeloc.y = -ballVeloc.y;\n                        }\n\n                    // check paddles for ball hitting it\n                    if (ballVeloc.x < 0) // ball is going left\n                        {\n                            if (ballCenter.x <= h / 25 + ballHeight / 2) // ball is to the left of the paddle\n                                {\n                                    if (ballCenter.y + ballHeight / 2 > paddleCenter[0].y - paddleHeight / 2 && ballCenter.y - ballHeight / 2 < paddleCenter[0].y + paddleHeight / 2) {\n                                        // bounce\n                                        bounce(0);\n                                        //ballVeloc.x = -ballVeloc.x;\n                                    } else {\n                                        // left loses, right gains 1 point\n                                        roundLost = 1;\n                                        posReset = false;\n                                        ballVeloc.dir = 1;\n                                        ++score[1];\n                                        checkScore();\n                                    }\n                                }\n                        } else // ball is going right\n                        {\n                            if (ballCenter.x >= w - h / 25 - ballHeight / 2) // ball is to the right of the paddle\n                                {\n                                    if (ballCenter.y + ballHeight / 2 > paddleCenter[1].y - paddleHeight / 2 && ballCenter.y - ballHeight / 2 < paddleCenter[1].y + paddleHeight / 2) {\n                                        // bounce\n                                        bounce(1);\n                                    } else {\n                                        // right loses, left gains 1 point\n                                        roundLost = 1;\n                                        posReset = false;\n                                        ballVeloc.dir = -1;\n                                        ++score[0];\n                                        checkScore();\n                                    }\n                                }\n                        }\n                    // move paddles\n                    for (var _i2 = 0; _i2 < paddleCenter.length; ++_i2) {\n                        var dir = void 0,\n                            k = void 0,\n                            actualDirection = void 0,\n                            speed = speedConst;\n                        if (cpu[_i2]) {\n                            dir = ballCenter.y < paddleCenter[_i2].y ? -1 : 1;\n                            var kV = Math.abs(ballCenter.y - paddleCenter[_i2].y) / h;\n                            var kH = 1 - Math.abs(ballCenter.x - paddleCenter[_i2].x) / w;\n                            k = kV * Math.sqrt(kH);\n                            actualDirection = paddleSpeed[_i2];\n                            speed *= 0.66;\n                        } else {\n                            dir = keys.direction[_i2];\n                            k = 0.2;\n                            actualDirection = dir;\n                        }\n                        if (actualDirection <= 0 // going up\n                        && paddleCenter[_i2].y - paddleHeight / 2 < h * 2 / 50 + ballHeight * 3 / 2) // above top\n                            {\n                                paddleSpeed[_i2] = 0;\n                                if (cpu[_i2]) paddleCenter[_i2].y = h * 2 / 50 + ballHeight * 3 / 2 + paddleHeight / 2;\n                            } else if (actualDirection >= 0 // going down\n                        && paddleCenter[_i2].y + paddleHeight / 2 > h * 48 / 50 - ballHeight * 3 / 2) // below bottom\n                            {\n                                paddleSpeed[_i2] = 0;\n                                if (cpu[_i2]) paddleCenter[_i2].y = h * 48 / 50 - ballHeight * 3 / 2 - paddleHeight / 2;\n                            } else {\n                            paddleSpeed[_i2] *= 1 - k;\n                            paddleSpeed[_i2] += k * dir;\n                            paddleCenter[_i2].y += speed * paddleSpeed[_i2];\n                        }\n                    }\n                }\n            }\n\n            ctx.fillStyle = 'rgba(0,0,0,0.91)';\n            ctx.fillRect(0, 0, w, h);\n            // draw stationary parts: centre and top/bottom lines\n            if (canvasBackground) {\n                ctx.drawImage(canvasBackground, 0, 0);\n            } else {\n                setupCanvas();\n            }\n\n            ctx.fillStyle = 'white';\n            // draw paddles\n            for (var _i3 = 0; _i3 < paddleCenter.length; ++_i3) {\n                ctx.fillRect(paddleCenter[_i3].x - paddleWidth / 2, paddleCenter[_i3].y - paddleHeight / 2, paddleWidth, paddleHeight);\n            }\n            var numWidth = h * 1 / 10;\n            var numHeight = goldenRatio * numWidth;\n            var lineWidth = h * 1.5 / 150;\n            // print score\n            if (score[0] !== 10 && score[1] !== 10) {\n                fillNumber(ctx, w * 11 / 25 - h * 3 / 50, h * 2 / 25, numWidth, numHeight, lineWidth, score[0]);\n                fillNumber(ctx, w * 14 / 25, h * 2 / 25, numWidth, numHeight, lineWidth, score[1]);\n            } else if (score[0] === 10) {\n                fillNumber(ctx, w * 11 / 25 - h * 3 / 50 - numWidth * 1.1, h * 2 / 25, numWidth, numHeight, lineWidth, 1);\n                fillNumber(ctx, w * 11 / 25 - h * 3 / 50, h * 2 / 25, numWidth, numHeight, lineWidth, 0);\n                fillNumber(ctx, w * 14 / 25, h * 2 / 25, numWidth, numHeight, lineWidth, score[1]);\n            } else if (score[1] === 10) {\n                fillNumber(ctx, w * 11 / 25 - h * 3 / 50, h * 2 / 25, numWidth, numHeight, lineWidth, score[0]);\n                fillNumber(ctx, w * 14 / 25, h * 2 / 25, numWidth, numHeight, lineWidth, 1);\n                fillNumber(ctx, w * 14 / 25 + numWidth * 1.1, h * 2 / 25, numWidth, numHeight, lineWidth, 0);\n            }\n            // draw ball\n            ctx.fillStyle = roundLost > 0 && roundLost % 0.2 >= 0.1 ? 'red' : 'white';\n            ctx.fillRect(ballCenter.x - ballHeight / 2, ballCenter.y - ballHeight / 2, ballHeight, ballHeight);\n        });\n    });\n});\n\n},{\"./keyboard\":6,\"animation-timer2\":1,\"jquery\":\"jquery\"}]},{},[7]);\n"],"sourceRoot":"/source/"}